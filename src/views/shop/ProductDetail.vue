<template>
  <v-container>
    <v-row>
      <v-col cols="6">
        <v-carousel
          cycle
          height="550px"
          hide-delimiter-background
          show-arrows-on-hover
          :touch="{ left: () => activeSlide--, right: () => activeSlide++ }"
        >
          <v-carousel-item
            v-for="(image, i) in images"
            :key="i"
            :src="`data:image/png;base64, ${image}`"
          />
        </v-carousel>
      </v-col>
      <v-col cols="6">
        <v-card>
          <v-card-title>상품명: {{ productName }}</v-card-title>
          <v-card-text>
            <v-row>
              <div>
                <v-chip
                  v-if="newArrival"
                  x-small
                  color="pink"
                  class="mx-1"
                  label
                  text-color="white"
                >
                  <!-- <v-icon left> mdi-label </v-icon> -->
                  신상품
                </v-chip>
                <v-chip
                  v-if="best"
                  x-small
                  color="pink"
                  class="mx-1"
                  label
                  text-color="white"
                >
                  <!-- <v-icon left> mdi-label </v-icon> -->
                  Best
                </v-chip>
                <v-chip
                  v-if="discount"
                  x-small
                  color="pink"
                  class="mx-1"
                  label
                  text-color="white"
                >
                  <!-- <v-icon left> mdi-label </v-icon> -->
                  할인
                </v-chip>
                <v-chip
                  v-if="productShowType === 'SOLDOUT'"
                  x-small
                  color="pink"
                  class="mx-1"
                  label
                  text-color="white"
                >
                  <!-- <v-icon left> mdi-label </v-icon> -->
                  품절
                </v-chip>
              </div>
            </v-row>
          </v-card-text>

          <v-card-text class="text--primary">
            <div>판매 가격: {{ salePrice }} 원</div>
            <div>포인트: 250</div>
            <div>상품 요약: {{ description }}</div>
          </v-card-text>
          <v-container>
            <v-row dense align="center">
              <v-col cols="auto"><div class="subtitle-1">옵션1:</div></v-col>
              <v-col>
                <v-select
                  :items="items"
                  label="옵션을 선택해 주세요."
                  hide-details
                  outlined
                  dense
                  :menu-props="{ offsetY: true }"
                />
              </v-col>
            </v-row>
            <v-row dense align="center">
              <v-col cols="auto"><div class="subtitle-1">옵션2:</div></v-col>
              <v-col>
                <v-select
                  :items="items"
                  label="옵션을 선택해 주세요."
                  hide-details
                  outlined
                  dense
                  :menu-props="{ offsetY: true }"
                />
              </v-col>
            </v-row>
          </v-container>
          <v-container>
            <v-row dense align="center">
              <v-col cols="auto"><div class="subtitle-1">수량:</div> </v-col>
              <v-col cols="3">
                <v-text-field outlined dense hide-details v-model="num" />
              </v-col>
              <v-col>
                <v-btn small class="mr-2" icon color="indigo" @click="plus"
                  ><v-icon>mdi-plus</v-icon></v-btn
                ><v-btn small icon color="indigo" @click="minus"
                  ><v-icon>mdi-minus</v-icon></v-btn
                >
              </v-col>
            </v-row>
            <v-row>
              <v-col>
                <div>배송비:</div>
              </v-col>
            </v-row>
            <v-row>
              <v-col>
                <div>총 결제 금액:</div>
              </v-col>
            </v-row>
          </v-container>
        </v-card>
        <div class="pt-5">
          <v-btn dark block large color="black" to="/style-shop/product-order">
            구매하기
          </v-btn>
        </div>
        <div class="pt-5" />
        <div>
          <v-btn block outlined large color="indigo" rai> 장바구니 </v-btn>
        </div>
      </v-col>
    </v-row>
    <v-row>
      <v-col cols="12">
        <v-tabs
          v-model="tab"
          centered
          fixed-tabs
          background-color="indigo"
          dark
          slider-color="red"
          slider-size="5"
        >
          <v-tab href="#tab-1"> 상품상세정보 </v-tab>
          <v-tab href="#tab-2"> 상품평 </v-tab>
          <v-tab href="#tab-3"> 상품문의 </v-tab>
          <v-tab href="#tab-4"> 배송안내 </v-tab>
          <v-tab href="#tab-5"> 교환 및 반품 </v-tab>
        </v-tabs>
        <v-tabs-items v-model="tab">
          <v-tab-item value="tab-1">
            <v-card flat>
              <p v-html="detailInfo" />
            </v-card>
          </v-tab-item>
          <v-tab-item value="tab-2">
            <product-comment />
          </v-tab-item>
          <v-tab-item value="tab-3">
            <product-qna />
          </v-tab-item>
          <v-tab-item value="tab-4">
            <v-card flat>
              <p v-html="shippingInfo" />
            </v-card>
          </v-tab-item>
          <v-tab-item value="tab-5">
            <v-card flat>
              <p v-html="exchangeReturnInfo" />
            </v-card>
          </v-tab-item>
        </v-tabs-items>
      </v-col>
    </v-row>
  </v-container>
</template>

<script>
import ProductComment from '@/components/shop/ProductComment';
import ProductQna from '@/components/shop/ProductQna.vue';
import { getProductById } from '@/api/shopProduct';

export default {
  created() {
    const productId = this.$route.params.productId;
    this.getProductById(productId);
  },
  data: () => ({
    images: null,
    productName: '',
    newArrival: null,
    best: null,
    discount: null,
    productShowType: null,
    salePrice: null,
    point: null,
    description: null,
    shippingFee: null,
    detailInfo: null,
    shippingInfo: null,
    exchangeReturnInfo: null,
    tab: null,
    items: ['Foo', 'Bar', 'Fizz', 'Buzz'],
    num: 1,
  }),
  components: {
    ProductComment,
    ProductQna,
  },
  methods: {
    async getProductById(productId) {
      try {
        const { data } = await getProductById({
          productId: productId,
        });
        console.log(data);
        this.images = data.byteImages;
        this.productName = data.productName;
        this.newArrival = data.newArrival;
        this.best = data.best;
        this.discount = data.discount;
        this.productShowType = data.productShowType;
        this.salePrice = data.salePrice;

        this.description = data.description;
        this.detailInfo = data.detailInfo;
        this.shippingInfo = data.shippingInfo;
        this.exchangeReturnInfo = data.exchangeReturnInfo;
      } catch (error) {
        console.log(error);
      }
    },
    plus() {
      this.num += 1;
    },
    minus() {
      if (this.num > 1) {
        this.num -= 1;
      }
    },
  },
};
</script>

<style></style>
